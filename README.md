# Medical Image Classifier

A medical image classification platform with deep learning models and Grad-CAM visualization support. Built with PyTorch, FastAPI, and React.

## Demo

ðŸ”— **Live Demo**: [medical-image-classifier-two.vercel.app](https://medical-image-classifier-two.vercel.app)

## Overview

This project provides:
- REST API for medical image classification
- Grad-CAM visualizations for model interpretability
- Interactive web frontend with side-by-side comparison and opacity slider
- Extensible architecture for adding new classification models

## Models

| Model | Task | Classes | Test Accuracy | AUC |
|-------|------|---------|---------------|-----|
| `brain_tumor` | MRI Classification | Glioma, Meningioma, Pituitary, No Tumor | 99% | - |
| `pneumonia` | Chest X-Ray Classification | Normal, Pneumonia | 88% | 0.958 |

## Results

### Brain Tumor MRI Classification

4-class classification achieving 99% test accuracy.

**Training Progress**

![Brain Tumor Training](assets/brain_tumor_training.png)

**Confusion Matrix**

![Brain Tumor Confusion Matrix](assets/brain_tumor_confusion_matrix.png)

**Grad-CAM Visualizations**

The model correctly identifies tumor regions across all classes:

![Brain Tumor Grad-CAM](assets/brain_tumor_gradcam.png)

### Pneumonia Detection

Binary classification from chest X-rays with 88% accuracy and 0.958 AUC.

**Training Progress**

![Pneumonia Training](assets/pneumonia_training.png)

**Confusion Matrix**

![Pneumonia Confusion Matrix](assets/pneumonia_confusion_matrix.png)

**ROC Curve**

![Pneumonia ROC Curve](assets/pneumonia_roc_curve.png)

**Grad-CAM Visualizations**

![Pneumonia Grad-CAM](assets/pneumonia_gradcam.png)

## Project Structure

```
medical-image-classifier/
â”œâ”€â”€ api/
â”‚   â”œâ”€â”€ app/
â”‚   â”‚   â”œâ”€â”€ main.py             # FastAPI application
â”‚   â”‚   â”œâ”€â”€ models/
â”‚   â”‚   â”‚   â”œâ”€â”€ base.py         # Base classifier interface
â”‚   â”‚   â”‚   â”œâ”€â”€ brain_tumor.py  # Brain tumor classifier
â”‚   â”‚   â”‚   â””â”€â”€ pneumonia.py    # Pneumonia classifier
â”‚   â”‚   â””â”€â”€ utils/
â”‚   â”‚       â””â”€â”€ gradcam.py      # Grad-CAM visualization
â”‚   â”œâ”€â”€ weights/                # Model weights (not tracked in git)
â”‚   â”œâ”€â”€ Dockerfile
â”‚   â”œâ”€â”€ fly.toml
â”‚   â””â”€â”€ requirements.txt
â”œâ”€â”€ frontend/
â”‚   â”œâ”€â”€ src/
â”‚   â”‚   â”œâ”€â”€ components/         # React components
â”‚   â”‚   â”œâ”€â”€ hooks/              # Custom hooks
â”‚   â”‚   â””â”€â”€ utils/              # API utilities
â”‚   â”œâ”€â”€ public/
â”‚   â”‚   â””â”€â”€ samples/            # Sample images for demo
â”‚   â”œâ”€â”€ package.json
â”‚   â””â”€â”€ vite.config.js
â”œâ”€â”€ notebooks/
â”‚   â”œâ”€â”€ brain_tumor_classifier.ipynb
â”‚   â””â”€â”€ pneumonia_classifier.ipynb
â””â”€â”€ assets/                     # README images
```

## Technical Details

### Model Architecture

Both models use EfficientNet-V2-S pretrained on ImageNet with custom classification heads:
- Input: 224x224 RGB images
- Backbone: EfficientNet-V2-S (frozen early layers)
- Classifier: Dropout(0.3) â†’ Linear(1280, 512) â†’ ReLU â†’ Dropout(0.15) â†’ Linear(512, num_classes)

### Grad-CAM

Visualizations generated by backpropagating target class scores and computing weighted activation maps from the last convolutional layer.

### Frontend Features

- Model selection (Brain Tumor / Pneumonia)
- Sample image gallery with labeled thumbnails
- Drag-and-drop file upload
- Side-by-side original vs heatmap comparison
- Interactive opacity slider for heatmap blending
- Class probability visualization
- Downloadable Grad-CAM overlays
- Mobile responsive design

### Datasets

- Brain Tumor: [Brain Tumor MRI Dataset](https://www.kaggle.com/datasets/masoudnickparvar/brain-tumor-mri-dataset)
- Pneumonia: [Chest X-Ray Pneumonia](https://www.kaggle.com/datasets/paultimothymooney/chest-xray-pneumonia)

## API Reference

Full API documentation available at [medical-image-api.fly.dev/docs](https://medical-image-api.fly.dev/docs)

### Endpoints

| Method | Endpoint | Description |
|--------|----------|-------------|
| `GET` | `/health` | Health check |
| `GET` | `/models` | List available models |
| `POST` | `/predict/{model_name}` | Classification |
| `POST` | `/predict/{model_name}/gradcam` | Classification with Grad-CAM |

## Local Development

### API

```bash
cd api
python -m venv venv
source venv/bin/activate
pip install -r requirements.txt

# Add weights to weights/

python -m uvicorn app.main:app --reload --port 8000
```

API docs: http://localhost:8000/docs

### Frontend

```bash
cd frontend
npm install

# Create .env.local for local development
echo "VITE_API_URL=http://localhost:8000" > .env.local

npm run dev
```

Frontend: http://localhost:5173

## License

MIT

## Acknowledgments

- [Brain Tumor MRI Dataset](https://www.kaggle.com/datasets/masoudnickparvar/brain-tumor-mri-dataset) by Masoud Nickparvar
- [Chest X-Ray Pneumonia Dataset](https://www.kaggle.com/datasets/paultimothymooney/chest-xray-pneumonia) by Paul Mooney
- [EfficientNet-V2](https://arxiv.org/abs/2104.00298) by Google Research
- [Grad-CAM](https://arxiv.org/abs/1610.02391) by Selvaraju et al.